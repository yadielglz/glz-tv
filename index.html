<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IPTV Playlist Player</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    
    :root {
      --bg: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      --fg: #ffffff;
      --accent: #00d4ff;
      --accent-glow: #00d4ff40;
      --bar: rgba(255, 255, 255, 0.1);
      --bar-border: rgba(255, 255, 255, 0.2);
      --modal-bg: rgba(0, 0, 0, 0.8);
      --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      --glass: rgba(255, 255, 255, 0.1);
      --glass-border: rgba(255, 255, 255, 0.2);
      --text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }
    
    body.light {
      --bg: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 50%, #f5f9ff 100%);
      --fg: #1a1a2e;
      --bar: rgba(255, 255, 255, 0.8);
      --bar-border: rgba(0, 0, 0, 0.1);
      --modal-bg: rgba(255, 255, 255, 0.9);
      --glass: rgba(255, 255, 255, 0.7);
      --glass-border: rgba(0, 0, 0, 0.1);
      --text-shadow: none;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      font-family: 'Orbitron', monospace;
      background: var(--bg);
      color: var(--fg);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      transition: all 0.3s ease;
      overflow: hidden;
    }
    
    /* Splash Screen */
    .splash {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .splash.hidden {
      opacity: 0;
      visibility: hidden;
    }
    
    .splash-logo {
      font-size: 3.5rem;
      font-weight: 900;
      color: var(--accent);
      text-shadow: 0 0 20px var(--accent-glow), var(--text-shadow);
      margin-bottom: 1rem;
      letter-spacing: 0.2em;
    }
    
    .splash-subtitle {
      font-size: 1.2rem;
      color: var(--fg);
      opacity: 0.8;
      margin-bottom: 2rem;
      letter-spacing: 0.1em;
    }
    
    .splash-loading {
      width: 60px;
      height: 60px;
      border: 3px solid var(--glass-border);
      border-top: 3px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .top-bar {
      background: var(--glass);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      color: var(--fg);
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 1.1em;
      font-weight: 700;
      box-shadow: var(--shadow);
      z-index: 2;
      letter-spacing: 0.05em;
    }
    
    .bottom-bar {
      background: var(--glass);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 1px solid var(--glass-border);
      color: var(--fg);
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 1.1em;
      font-weight: 700;
      box-shadow: var(--shadow);
      z-index: 2;
      position: fixed;
      bottom: 0; left: 0; right: 0;
      letter-spacing: 0.05em;
    }
    
    .channel-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .channel-logo {
      width: 40px; height: 40px;
      object-fit: contain;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    
    .settings-btn {
      background: var(--glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 50%;
      color: var(--fg);
      font-size: 1.5em;
      cursor: pointer;
      padding: 0.5rem;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
    }
    
    .settings-btn:hover {
      background: var(--accent);
      color: #fff;
      transform: scale(1.1);
      box-shadow: 0 0 20px var(--accent-glow);
    }
    
    .player-wrap {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      min-height: 300px;
      background: linear-gradient(135deg, #000 0%, #1a1a2e 100%);
      overflow: hidden;
    }
    
    .player-wrap::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: radial-gradient(circle at 50% 50%, rgba(0, 212, 255, 0.1) 0%, transparent 70%);
      pointer-events: none;
    }
    
    body.light .player-wrap {
      background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%);
    }
    
    video, audio {
      max-width: 100vw;
      max-height: 70vh;
      background: #000;
      border-radius: 15px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      outline: none;
      border: 1px solid var(--glass-border);
    }
    
    body.light video, body.light audio {
      background: #fff;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    }
    
    .stop-btn {
      position: absolute;
      top: 1.5rem; right: 1.5rem;
      background: var(--glass);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      color: var(--fg);
      border-radius: 50%;
      width: 50px; height: 50px;
      font-size: 1.5em;
      cursor: pointer;
      box-shadow: var(--shadow);
      z-index: 3;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      font-weight: 700;
    }
    
    .stop-btn:hover {
      background: #ff4757;
      color: #fff;
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(255, 71, 87, 0.5);
    }
    
    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: var(--modal-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .modal-content {
      background: var(--glass);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      border: 1px solid var(--glass-border);
      color: var(--fg);
      border-radius: 20px;
      padding: 2rem;
      min-width: 400px;
      max-width: 95vw;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: var(--shadow);
      position: relative;
    }
    
    .modal-close {
      position: absolute;
      top: 1rem; right: 1.5rem;
      background: var(--glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 50%;
      color: var(--fg);
      font-size: 1.5em;
      cursor: pointer;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .modal-close:hover {
      background: #ff4757;
      color: #fff;
      transform: scale(1.1);
    }
    
    .channel-list {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
      margin-bottom: 2rem;
      max-height: 45vh;
      overflow-y: auto;
      padding-right: 0.5rem;
    }
    
    .channel-list::-webkit-scrollbar {
      width: 6px;
    }
    
    .channel-list::-webkit-scrollbar-track {
      background: var(--glass);
      border-radius: 3px;
    }
    
    .channel-list::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 3px;
    }
    
    .channel-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid transparent;
      background: var(--glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    
    .channel-item.selected, .channel-item:hover {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
      transform: translateX(5px);
      box-shadow: 0 5px 20px var(--accent-glow);
    }
    
    .channel-item.selected .channel-logo, .channel-item:hover .channel-logo {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.3);
    }
    
    .modal-section h3 {
      margin: 0 0 1rem 0;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--accent);
      text-shadow: var(--text-shadow);
      letter-spacing: 0.1em;
    }
    
    .toggle-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
      padding: 0.8rem;
      background: var(--glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
    }
    
    .toggle-label {
      flex: 1;
      font-weight: 500;
      letter-spacing: 0.05em;
    }
    
    .toggle-switch {
      width: 50px; height: 28px;
      background: var(--glass-border);
      border-radius: 14px;
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-block;
      border: 1px solid var(--glass-border);
    }
    
    .toggle-switch[data-on="true"] {
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent-glow);
    }
    
    .toggle-knob {
      position: absolute;
      top: 2px; left: 2px;
      width: 24px; height: 24px;
      background: #fff;
      border-radius: 50%;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    .toggle-switch[data-on="true"] .toggle-knob {
      left: 24px;
      box-shadow: 0 2px 8px rgba(0, 212, 255, 0.3);
    }
    
    .error-msg {
      color: #ff4757;
      margin-top: 1rem;
      font-weight: 700;
      text-align: center;
      text-shadow: var(--text-shadow);
      background: var(--glass);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 71, 87, 0.3);
      border-radius: 10px;
      padding: 1rem;
    }
    
    @media (max-width: 600px) {
      .modal-content { padding: 1.5rem; min-width: 320px; }
      .top-bar, .bottom-bar { font-size: 1em; padding: 1rem; }
      .channel-logo { width: 32px; height: 32px; }
      .splash-logo { font-size: 2.5rem; }
      .splash-subtitle { font-size: 1rem; }
    }
  </style>
</head>
<body>
  <!-- Splash Screen -->
  <div id="splash" class="splash">
    <div class="splash-logo">GLZ TV</div>
    <div class="splash-subtitle">Premium IPTV Experience</div>
    <div class="splash-loading"></div>
  </div>

  <div id="app" style="display:flex; flex:1; flex-direction:column; min-height:100vh;">
    <div class="top-bar">
      <span>GLZ TV</span>
      <span id="clock"></span>
    </div>
    <div class="player-wrap">
      <button class="stop-btn" id="stop-btn" title="Stop">⏹</button>
      <video id="video" controls autoplay playsinline style="display:none"></video>
      <audio id="audio" controls autoplay style="display:none"></audio>
      <div id="player-error" class="error-msg" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:none"></div>
    </div>
    <div class="bottom-bar">
      <div class="channel-info">
        <img id="current-logo" class="channel-logo" src="" alt="" style="display:none">
        <span id="current-name"></span>
      </div>
      <button class="settings-btn" id="settings-btn" title="Settings">⚙</button>
    </div>
  </div>
  <div id="modal" class="modal" style="display:none">
    <div class="modal-content">
      <button class="modal-close" id="modal-close" title="Close">&times;</button>
      <div class="modal-section">
        <h3>Channel List</h3>
        <div class="channel-list" id="channel-list"></div>
      </div>
      <div class="modal-section">
        <h3>Settings</h3>
        <div class="toggle-row">
          <span class="toggle-label">Light Mode</span>
          <span class="toggle-switch" id="light-toggle" data-on="false"><span class="toggle-knob"></span></span>
        </div>
        <div class="toggle-row">
          <span class="toggle-label">Auto-hide Controls</span>
          <span class="toggle-switch" id="autohide-toggle" data-on="false"><span class="toggle-knob"></span></span>
        </div>
        <div class="toggle-row">
          <span class="toggle-label">24h Clock</span>
          <span class="toggle-switch" id="clock-toggle" data-on="false"><span class="toggle-knob"></span></span>
        </div>
      </div>
    </div>
  </div>
  <!-- hls.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.7/dist/hls.min.js"></script>
  <script>
    // --- Embedded M3U Content ---
    const EMBEDDED_M3U = `#EXTM3U url-tvg="https://epg.best/1eef8-shw7fc.xml.gz" x-tvg-url="https://epg.best/1eef8-shw7fc.xml.gz"
#EXTINF:-1 tvg-id="WKAQ.us" tvg-name="WKAQ   TELEMUNDO PR" tvg-logo="https://i.ibb.co/gLVK5Swz/TEL.png" tvg-chno="102" channel-id="102" group-title="TV",WKAQ   TELEMUNDO PR
https://nbculocallive.akamaized.net/hls/live/2037499/puertorico/stream1/master_1080.m3u8
#EXTINF:-1 tvg-id="WKAQDT2.us" tvg-name="WKAQ2   PUNTO 2" tvg-logo="https://static.epg.best/us/WKAQDT2.us.png" tvg-chno="103" channel-id="103" group-title="TV",WKAQ2   PUNTO 2
https://nbculocallive.akamaized.net/hls/live/2037499/puertorico/stream2/master_720.m3u8
#EXTINF:-1 tvg-id="UniMas.us" tvg-name="UNIMAS HD" tvg-logo="https://static.epg.best/us/UniMas.us.png" tvg-chno="104" channel-id="104" group-title="TV",UNIMAS HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/unimas.network.east.us.m3u8
#EXTINF:-1 tvg-id="WLII.us" tvg-name="WLII   TELEONCE" tvg-logo="https://static.epg.best/us/WLII.us.png" tvg-chno="105" channel-id="105" group-title="TV",WLII   TELEONCE
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/uni.wlii.puerto.rico.us.m3u8
#EXTINF:-1 tvg-id="WIPRTV.us" tvg-name="WIPR   PUERTO RICO TV" tvg-logo="https://static.epg.best/us/WIPRTV.us.png" tvg-chno="106" channel-id="106" group-title="TV",WIPR   PUERTO RICO TV
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/wipr.pr.m3u8
#EXTINF:-1 tvg-id="ESPN.us" tvg-name="ESPN HD" tvg-logo="https://i.ibb.co/mrs1mDXw/ESPN-png.png" tvg-chno="110" channel-id="110" group-title="TV",ESPN HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/espn.us.m3u8
#EXTINF:-1 tvg-id="ESPN2.us" tvg-name="ESPN 2 HD" tvg-logo="https://static.epg.best/us/ESPN2.us.png" tvg-chno="111" channel-id="111" group-title="TV",ESPN 2 HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/espn2.us.m3u8
#EXTINF:-1 tvg-id="ESPNNews.us" tvg-name="ESPN NEWS HD" tvg-logo="https://static.epg.best/us/ESPNNews.us.png" tvg-chno="112" channel-id="112" group-title="TV",ESPN NEWS HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/espn.news.us.m3u8
#EXTINF:-1 tvg-id="ESPNU.us" tvg-name="ESPN U HD" tvg-logo="https://static.epg.best/us/ESPNU.us.png" tvg-chno="113" channel-id="113" group-title="TV",ESPN U HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/espn.u.us.m3u8
#EXTINF:-1 tvg-id="FoxSports1.us" tvg-name="FOX SPORTS 1" tvg-logo="https://i.ibb.co/0pqwYytp/FS1.png" tvg-chno="114" channel-id="114" group-title="TV",FOX SPORTS 1
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fox.sports.1.us.m3u8
#EXTINF:-1 tvg-id="FoxSports2.us" tvg-name="FOX SPORTS 2" tvg-logo="https://i.ibb.co/PGYdrN3r/FS2.png" tvg-chno="115" channel-id="115" group-title="TV",FOX SPORTS 2
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fox.sports.2.us.m3u8
#EXTINF:-1 tvg-id="MLBNetwork.us" tvg-name="MLB NETWORK" tvg-logo="https://static.epg.best/us/MLBNetwork.us.png" tvg-chno="116" channel-id="116" group-title="TV",MLB NETWORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/mlb.network.us.m3u8
#EXTINF:-1 tvg-id="NFLNetwork.us" tvg-name="NFL NETWORK" tvg-logo="https://static.epg.best/us/NFLNetwork.us.png" tvg-chno="117" channel-id="117" group-title="TV",NFL NETWORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nfl.network.us.m3u8
#EXTINF:-1 tvg-id="NBATV.us" tvg-name="NBA TV" tvg-logo="https://static.epg.best/us/NBATV.us.png" tvg-chno="118" channel-id="118" group-title="TV",NBA TV
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nba.tv.usa.us.m3u8
#EXTINF:-1 tvg-id="YESNetwork.us" tvg-name="YES NETWORK" tvg-logo="https://static.epg.best/us/YESNetwork.us.png" tvg-chno="119" channel-id="119" group-title="TV",YES NETWORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/yes.network.us.m3u8
#EXTINF:-1 tvg-id="SportsNetNewYork.us" tvg-name="SPORTSNET NEW YORK" tvg-logo="https://static.epg.best/us/SportsNetNewYork.us.png" tvg-chno="120" channel-id="120" group-title="TV",SPORTSNET NEW YORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/sny.sportsnet.new.york.us.m3u8
#EXTINF:-1 tvg-id="WESH.us" tvg-name="WESH   NBC ORLANDO" tvg-logo="https://static.epg.best/us/WESH.us.png" tvg-chno="121" channel-id="121" group-title="TV",WESH   NBC ORLANDO
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nbc.wesh.winter.park.fl.us.m3u8
#EXTINF:-1 tvg-id="WKMG.us" tvg-name="WKMG   CBS ORLANDO" tvg-logo="https://static.epg.best/us/WKMG.us.png" tvg-chno="122" channel-id="122" group-title="TV",WKMG   CBS ORLANDO
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/cbs.wkmg.orlando.fl.us.m3u8
#EXTINF:-1 tvg-id="WFTV.us" tvg-name="WFTV   ABC ORLANDO" tvg-logo="https://static.epg.best/us/WFTV.us.png" tvg-chno="123" channel-id="123" group-title="TV",WFTV   ABC ORLANDO
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/abc.wftv.orlando.fl.us.m3u8
#EXTINF:-1 tvg-id="WOFL.us" tvg-name="WOFL   FOX ORLANDO" tvg-logo="https://static.epg.best/us/WOFL.us.png" tvg-chno="124" channel-id="124" group-title="TV",WOFL   FOX ORLANDO
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fox.wofl.orlando.fl.us.m3u8
#EXTINF:-1 tvg-id="WKCF.us" tvg-name="WKCF   CW 18 ORLANDO" tvg-logo="https://i.ibb.co/cK2GwV7r/CW18-Clear.png" tvg-chno="125" channel-id="125" group-title="TV",WKCF   CW 18 ORLANDO
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/cw.wkcf.orlando.fl.us.m3u8
#EXTINF:-1 tvg-id="ComedyCentral.us" tvg-name="COMEDY CENTRAL" tvg-logo="https://static.epg.best/us/ComedyCentral.us.png" tvg-chno="129" channel-id="129" group-title="TV",COMEDY CENTRAL
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/comedy.central.eastern.us.m3u8
#EXTINF:-1 tvg-id="USANetwork.us" tvg-name="USA NETWORK" tvg-logo="https://i.ibb.co/VprcTcV8/USAN.png" tvg-chno="130" channel-id="130" group-title="TV",USA NETWORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/usa.network.east.us.m3u8
#EXTINF:-1 tvg-id="TBS.us" tvg-name="TBS HD" tvg-logo="https://static.epg.best/us/TBS.us.png" tvg-chno="131" channel-id="131" group-title="TV",TBS HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/tbs.east.us.m3u8
#EXTINF:-1 tvg-id="ParamountNetwork.us" tvg-name="PARAMOUNT NETWORK" tvg-logo="https://static.epg.best/us/ParamountNetwork.us.png" tvg-chno="132" channel-id="132" group-title="TV",PARAMOUNT NETWORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/paramount.network.usa.eastern.us.m3u8
#EXTINF:-1 tvg-id="TNT.us" tvg-name="TNT HD" tvg-logo="https://static.epg.best/us/TNT.us.png" tvg-chno="133" channel-id="133" group-title="TV",TNT HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/tnt.east.us.m3u8
#EXTINF:-1 tvg-id="FX.us" tvg-name="FX NETWORK" tvg-logo="https://static.epg.best/us/FX.us.png" tvg-chno="134" channel-id="134" group-title="TV",FX NETWORK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fx.networks.east.coast.us.m3u8
#EXTINF:-1 tvg-id="FXX.us" tvg-name="FXX HD" tvg-logo="https://static.epg.best/us/FXX.us.png" tvg-chno="135" channel-id="135" group-title="TV",FXX HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fxx.usa.eastern.us.m3u8
#EXTINF:-1 tvg-id="FXMovieChannel.us" tvg-name="FX MOVIE" tvg-logo="https://static.epg.best/us/FXMovieChannel.us.png" tvg-chno="136" channel-id="136" group-title="TV",FX MOVIE
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fx.movie.channel.us.m3u8
#EXTINF:-1 tvg-id="DisneyChannel.us" tvg-name="DISNEY" tvg-logo="https://static.epg.best/us/DisneyChannel.us.png" tvg-chno="137" channel-id="137" group-title="TV",DISNEY
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/disney.eastern.us.m3u8
#EXTINF:-1 tvg-id="DisneyJunior.us" tvg-name="DISNEY JR" tvg-logo="https://static.epg.best/us/DisneyJunior.us.png" tvg-chno="138" channel-id="138" group-title="TV",DISNEY JR
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/disney.junior.usa.east.us.m3u8
#EXTINF:-1 tvg-id="Nickelodeon.us" tvg-name="NICK" tvg-logo="https://i.ibb.co/4w26j1Bj/nick-nickelodeon-logo-removebg-preview.png" tvg-chno="139" channel-id="139" group-title="TV",NICK
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nickelodeon.usa.east.us.m3u8
#EXTINF:-1 tvg-id="CartoonNetwork.us" tvg-name="CARTOON HD" tvg-logo="https://static.epg.best/us/CartoonNetwork.us.png" tvg-chno="140" channel-id="140" group-title="TV",CARTOON HD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/cartoon.network.usa.eastern.us.m3u8
#EXTINF:-1 tvg-id="Boomerang.us" tvg-name="BOOMERANG" tvg-logo="https://static.epg.best/us/Boomerang.us.png" tvg-chno="141" channel-id="141" group-title="TV",BOOMERANG
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/boomerang.us.m3u8
#EXTINF:-1 tvg-id="WFOR.us" tvg-name="WFOR   CBS MIAMI" tvg-logo="https://image.roku.com/developer_channels/prod/74a606e94c1077b1b1ae6d33f8b6c9b854fce9dd54784386679e9d10cf002cdd.png" tvg-chno="142" channel-id="142" group-title="TV",WFOR   CBS MIAMI
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/cbs.wfor.miami.fl.us.m3u8
#EXTINF:-1 tvg-id="WTSP.us" tvg-name="WTSP   CBS TAMPA" tvg-logo="https://static.epg.best/us/WTSP.us.png" tvg-chno="181" channel-id="181" group-title="TV",WTSP   CBS TAMPA
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/cbs.wtsp.tampa.bay.fl.us.m3u8
#EXTINF:-1 tvg-id="WTVT.us" tvg-name="WTVT   FOX TAMPA" tvg-logo="https://static.epg.best/us/WTVT.us.png" tvg-chno="182" channel-id="182" group-title="TV",WTVT   FOX TAMPA
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fox.wtvt.tampa.bay.fl.us.m3u8
#EXTINF:-1 tvg-id="WFTS.us" tvg-name="WFTS   ABC TAMPA" tvg-logo="https://static.epg.best/us/WFTS.us.png" tvg-chno="183" channel-id="183" group-title="TV",WFTS   ABC TAMPA
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/abc.wfts.tampa.bay.fl.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="WRMD   TELEMUNDO TAMPA" tvg-logo="https://static.wikia.nocookie.net/tvstations/images/2/2c/Telemundo_49_2018.png" tvg-chno="184" channel-id="184" group-title="TV",WRMD   TELEMUNDO TAMPA
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/telemundo.wrmd.tampa.fl.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="BALLY SPORTS SUN" tvg-logo="https://i.ibb.co/jv7mZWLM/Bally-Sports-Sun.png" tvg-chno="185" channel-id="185" group-title="TV",BALLY SPORTS SUN
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/bally.sports.sun.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="BALLY SPORTS FLORIDA" tvg-logo="https://i.ibb.co/cXyJC9Nf/Bally-Sports-Florida-logo.png" tvg-chno="186" channel-id="186" group-title="TV",BALLY SPORTS FLORIDA
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/fox.sports.florida.us.m3u8
#EXTINF:-1 tvg-id="DiscoveryEspanol.us" tvg-name="DISCOVERY EN ESPAÑOL" tvg-logo="https://static.epg.best/us/DiscoveryEspanol.us.png" tvg-chno="187" channel-id="187" group-title="TV",DISCOVERY EN ESPAÑOL
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/discovery.en.espanol.us.m3u8
#EXTINF:-1 tvg-id="DiscoveryFamilia.us" tvg-name="DISCOVERY FAMILIA" tvg-logo="https://static.epg.best/us/DiscoveryFamilia.us.png" tvg-chno="188" channel-id="188" group-title="TV",DISCOVERY FAMILIA
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/discovery.familia.us.m3u8
#EXTINF:-1 tvg-id="DiscoveryTurboLatinAmerica.pa" tvg-name="DISCOVERY TURBO" tvg-logo="https://static.epg.best/pa/DiscoveryTurboLatinAmerica.pa.png" tvg-chno="189" channel-id="189" group-title="TV",DISCOVERY TURBO
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/discovery.turbo.co.m3u8
#EXTINF:-1 tvg-id="DiscoveryWorld.mx" tvg-name="DISCOVERY WORLD" tvg-logo="https://static.epg.best/mx/DiscoveryWorld.mx.png" tvg-chno="190" channel-id="190" group-title="TV",DISCOVERY WORLD
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/discovery.world.co.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[MLB PPV] NY YANKEES" tvg-logo="https://logos-world.net/wp-content/uploads/2020/05/New-York-Yankees-Logo.png" tvg-chno="200" channel-id="200" group-title="TV",[MLB PPV] NY YANKEES
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/mlb.teams.nyy.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[MLB PPV] NY METS" tvg-logo="https://logos-world.net/wp-content/uploads/2020/05/New-York-Mets-Emblem.png" tvg-chno="201" channel-id="201" group-title="TV",[MLB PPV] NY METS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/mlb.teams.nym.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[MLB PPV] MIA MARLINS" tvg-logo="https://brandlogos.net/wp-content/uploads/2025/02/miami_marlins-logo_brandlogos.net_9fcup.png" tvg-chno="202" channel-id="202" group-title="TV",[MLB PPV] MIA MARLINS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/mlb.teams.mia.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[MLB PPV] DET TIGERS" tvg-logo="https://loodibee.com/wp-content/uploads/Detroit-Tigers-Logo-1994-2005.png" tvg-chno="203" channel-id="203" group-title="TV",[MLB PPV] DET TIGERS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/mlb.teams.det.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[MLB PPV] TB RAYS" tvg-logo="https://nbcsports.brightspotcdn.com/dims4/default/08447de/2147483647/strip/true/crop/1708x961+0+2/resize/1440x810!/quality/90/?url=https%3A%2F%2Fnbc-sports-production-nbc-sports.s3.us-east-1.amazonaws.com%2Fbrightspot%2Fda%2Fb1%2F467bd3792de4c26bd6743d2b7266%2Ftbr2015-3d-primary-rgb-e1442678074633.png" tvg-chno="204" channel-id="204" group-title="TV",[MLB PPV] TB RAYS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/mlb.teams.tb.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[NBA PPV] GS WARRIORS" tvg-logo="https://athlonsports.com/.image/c_limit%2Ccs_srgb%2Cq_auto:good%2Cw_500/MjA1MjcyMjkxNzYxNDY0ODUy/golden-state-warriors-logo.webp" tvg-chno="205" channel-id="205" group-title="TV",[NBA PPV] GS WARRIORS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nba.golden.state.warriors.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[NBA PPV] NY KNICKS" tvg-logo="https://upload.wikimedia.org/wikipedia/sco/d/d8/NewYorkKnicks.PNG" tvg-chno="206" channel-id="206" group-title="TV",[NBA PPV] NY KNICKS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nba.new.york.knicks.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[NBA PPV] DEN NUGGETS" tvg-logo="https://www.flagcolorcodes.com/data/NBA-Denver-Nuggets.png" tvg-chno="207" channel-id="207" group-title="TV",[NBA PPV] DEN NUGGETS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nba.denver.nuggets.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[NBA PPV] OKC THUNDER" tvg-logo="https://i.pinimg.com/736x/47/ea/93/47ea93e7a7b5f898d833ef218f3cd833.jpg" tvg-chno="208" channel-id="208" group-title="TV",[NBA PPV] OKC THUNDER
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nba.oklahoma.city.thunder.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[NBA PPV] IND PACERS" tvg-logo="https://www.flagcolorcodes.com/data/NBA-Indiana-Pacers.png" tvg-chno="209" channel-id="209" group-title="TV",[NBA PPV] IND PACERS
https://starlite.best/api/stream/throwaway.mgk343@gmail.com/167848/livetv.epg/nba.indiana.pacers.us.m3u8
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] WKAQ 580 [AM: 580 Khz] WKAQ-AM" tvg-logo="https://i.ibb.co/Vc9wh11d/wkaqam.png" tvg-chno="210" channel-id="210" group-title="TV",[R] WKAQ 580 [AM: 580 Khz] WKAQ-AM
https://televicentro.streamguys1.com/wkaqqam-icy?key=ae6a3b84b2caabf9d96d28dc1d8e3ebc2cc0ecce9ef074936108cb8cccf7964d&source=tunein&source=TuneIn&gdpr=0&us_privacy=1YNY&bundle=tunein.com&lat=28.0699&long=-81.8107
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] NotiUno [AM: 630 Khz] WUNO-AM" tvg-logo="https://www.unoradio.com/logos/logos/notiuno/notiuno630.png" tvg-chno="211" channel-id="211" group-title="TV",[R] NotiUno [AM: 630 Khz] WUNO-AM
https://server20.servistreaming.com:9022/stream
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Radio Once [AM: 1120 Khz] WMSW-AM" tvg-logo="https://www.radioonce.com/templates/rt_galatea/custom/images/demo/home/header/logo-radio11.png" tvg-chno="212" channel-id="212" group-title="TV",[R] Radio Once [AM: 1120 Khz] WMSW-AM
http://whsh4u-panel.com:14167/stream
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Radio Isla [AM: 1320 Khz] WSKN-AM" tvg-logo="https://radioisla.tv/wp-content/uploads/2019/06/Logo-Radio-Isla.png" tvg-chno="213" channel-id="213" group-title="TV",[R] Radio Isla [AM: 1320 Khz] WSKN-AM
https://server7.servistreaming.com/proxy/RadioIsla?mp=%2Fstream%3Ftype%3D.mp3&_=1
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Radio Tiempo [AM: 1430 Khz] WNLE-AM" tvg-logo="https://radiotiempo.net/wp-content/uploads/2022/08/tiempo-172x128.png" tvg-chno="214" channel-id="214" group-title="TV",[R] Radio Tiempo [AM: 1430 Khz] WNLE-AM
https://server7.servistreaming.com/proxy/tiempo?mp=%2Fstream%3Ftype%3D.mp3&_=1
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Radio Cumbre [AM: 1470 Khz] WKUM-AM" tvg-logo="https://i.ibb.co/5g2402Cc/wkum-png.png" tvg-chno="215" channel-id="215" group-title="TV",[R] Radio Cumbre [AM: 1470 Khz] WKUM-AM
https://sp.unoredcdn.net/8158/stream/1/
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Radio Oro [FM: 92.5 Mhz] WORO-FM" tvg-logo="https://i.ibb.co/nqbSmS1M/worofm-processed.png" tvg-chno="216" channel-id="216" group-title="TV",[R] Radio Oro [FM: 92.5 Mhz] WORO-FM
https://us2.internet-radio.com/proxy/woro?mp=/stream
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Z 93 [FM: 93.7 Mhz] WZNT-FM" tvg-logo="https://i.ibb.co/23BMsKBY/wznt-png.png" tvg-chno="217" channel-id="217" group-title="TV",[R] Z 93 [FM: 93.7 Mhz] WZNT-FM
https://liveaudio.lamusica.com/PR_WZNT_icy
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] La Nueva 94 [FM: 94.7 Mhz] WODA-FM" tvg-logo="https://i.ibb.co/sv1RBc08/wodalogo.png" tvg-chno="218" channel-id="218" group-title="TV",[R] La Nueva 94 [FM: 94.7 Mhz] WODA-FM
https://liveaudio.lamusica.com/PR_WODA_icy
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Fidelity [FM: 95.7 Mhz] WFID-FM" tvg-logo="https://fidelitypr.com/wp-content/uploads/2022/01/cropped-Redisen%CC%83o-Logo-Fidelity-3-15-2048x677.png" tvg-chno="219" channel-id="219" group-title="TV",[R] Fidelity [FM: 95.7 Mhz] WFID-FM
https://server7.servistreaming.com/proxy/fidelity?mp=%2Fstream%3Ftype%3D.mp3&_=1
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Estéreotempo [FM; 96.5 Mhz] WRXD-FM" tvg-logo="https://i.ibb.co/F4GM0W81/wrxr.png" tvg-chno="220" channel-id="220" group-title="TV",[R] Estéreotempo [FM; 96.5 Mhz] WRXD-FM
https://liveaudio.lamusica.com/PR_WRXD_icy
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Magic [FM; 97.3 Mhz] WOYE-FM" tvg-logo="https://i.ibb.co/Z6WqXPzV/woye.png" tvg-chno="221" channel-id="221" group-title="TV",[R] Magic [FM; 97.3 Mhz] WOYE-FM
https://stream.eleden.com:8210/magic.aac
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Salsoul [FM: 99.1 Mhz] WPRM-FM" tvg-logo="https://salsoul.com/wp-content/uploads/2020/12/cropped-salsoul-2.png" tvg-chno="222" channel-id="222" group-title="TV",[R] Salsoul [FM: 99.1 Mhz] WPRM-FM
https://server20.servistreaming.com:9023/stream?type=.mp3&_=1
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] LA X [FM: 100.7 Mhz] WXYX-FM" tvg-logo="https://i.ibb.co/zWDcRnBw/laxpng.png" tvg-chno="223" channel-id="223" group-title="TV",[R] LA X [FM: 100.7 Mhz] WXYX-FM
https://stream.eleden.com:8230/La X.aac
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] HOT 102 [FM 102.5 Mhz] WTOK-FM" tvg-logo="https://hot102pr.com/wp-content/uploads/2023/10/Artboard-4.png" tvg-chno="224" channel-id="224" group-title="TV",[R] HOT 102 [FM 102.5 Mhz] WTOK-FM
https://server7.servistreaming.com/proxy/hot?mp=%2Fstream%3Ftype%3D.mp3&_=1
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] La Mega PR [FM: 106.9 Mhz] WMEG-FM" tvg-logo="https://i.ibb.co/Xrp2nhpQ/WMEG-PNG.png" tvg-chno="225" channel-id="225" group-title="TV",[R] La Mega PR [FM: 106.9 Mhz] WMEG-FM
https://liveaudio.lamusica.com/PR_WMEG_icy
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] KQ105 [FM: 104.7 Mhz] WKAQ-FM" tvg-logo="https://upload.wikimedia.org/wikipedia/en/8/80/KQ_105_WKAQ-FM_2014_logo.png" tvg-chno="226" channel-id="226" group-title="TV",[R] KQ105 [FM: 104.7 Mhz] WKAQ-FM
https://televicentro.streamguys1.com/wkaqfm-icy?key=ae6a3b84b2caabf9d96d28dc1d8e3ebc2cc0ecce9ef074936108cb8cccf7964d&source=tunein&source=TuneIn&gdpr=0&us_privacy=1YNY&bundle=tunein.com&lat=28.0699&long=-81.8107
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Latino 99" tvg-logo="https://mm.aiircdn.com/371/5928f28889f51.png" tvg-chno="227" channel-id="227" group-title="TV",[R] Latino 99
https://lmmradiocast.com/Latino99fm?_=68068
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] Salseo Radio" tvg-logo="https://static.wixstatic.com/media/8dfec0_3e265a2f0fb5417c90c55be4e4e7d3cf~mv2.png/v1/fill/w_276,h_120,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/LOGOSALSEORADIO_clipped_rev_2_v2%20(1).png" tvg-chno="228" channel-id="228" group-title="TV",[R] Salseo Radio
https://listen.radioking.com/radio/399811/stream/452110
#EXTINF:-1 tvg-id="DummyChannel.us" tvg-name="[R] La Vieja Z [GLZ Radio]" tvg-logo="https://i.ibb.co/d4VZVjj2/LVZ8-removebg-preview.png" tvg-chno="229" channel-id="229" group-title="TV",[R] La Vieja Z [GLZ Radio]
https://s3.free-shoutcast.com/stream/18094
`;
    // --- State ---
    let channels = [];
    let current = 0;
    let lightMode = false;
    let autoHide = false;
    let clock24 = false;
    let lastType = 'video';
    let hls = null;
    // --- Elements ---
    const splash = document.getElementById('splash');
    const video = document.getElementById('video');
    const audio = document.getElementById('audio');
    const stopBtn = document.getElementById('stop-btn');
    const playerError = document.getElementById('player-error');
    const currentLogo = document.getElementById('current-logo');
    const currentName = document.getElementById('current-name');
    const settingsBtn = document.getElementById('settings-btn');
    const modal = document.getElementById('modal');
    const modalClose = document.getElementById('modal-close');
    const channelList = document.getElementById('channel-list');
    const lightToggle = document.getElementById('light-toggle');
    const autohideToggle = document.getElementById('autohide-toggle');
    const clockToggle = document.getElementById('clock-toggle');
    const clock = document.getElementById('clock');
    // --- Helpers ---
    function parseM3U(m3u) {
      const lines = m3u.split(/\r?\n/);
      const chs = [];
      let cur = null;
      for (let i = 0; i < lines.length; ++i) {
        const l = lines[i].trim();
        if (l.startsWith('#EXTINF')) {
          const attrs = {};
          const attrRe = /(\w+\-?\w*)="([^"]*)"/g;
          let m;
          while ((m = attrRe.exec(l))) attrs[m[1]] = m[2];
          const name = l.split(',').pop().trim();
          cur = {
            name: attrs['tvg-name'] || name,
            logo: attrs['tvg-logo'] || '',
            url: '',
            group: attrs['group-title'] || '',
            id: attrs['tvg-id'] || '',
            chno: attrs['tvg-chno'] || '',
            raw: l
          };
        } else if (cur && l && !l.startsWith('#')) {
          cur.url = l;
          chs.push(cur);
          cur = null;
        }
      }
      return chs;
    }
    function saveState() {
      localStorage.setItem('iptv_last', current);
      localStorage.setItem('iptv_light', lightMode ? '1' : '0');
      localStorage.setItem('iptv_autohide', autoHide ? '1' : '0');
      localStorage.setItem('iptv_clock24', clock24 ? '1' : '0');
      localStorage.setItem('iptv_channels', JSON.stringify(channels));
    }
    function loadState() {
      current = +(localStorage.getItem('iptv_last') || 0);
      lightMode = localStorage.getItem('iptv_light') === '1';
      autoHide = localStorage.getItem('iptv_autohide') === '1';
      clock24 = localStorage.getItem('iptv_clock24') === '1';
      const chs = localStorage.getItem('iptv_channels');
      if (chs) channels = JSON.parse(chs);
    }
    function setLight(l) {
      lightMode = l;
      document.body.classList.toggle('light', l);
      lightToggle.setAttribute('data-on', l);
      saveState();
    }
    function setAutohide(a) {
      autoHide = a;
      autohideToggle.setAttribute('data-on', a);
      if (a) {
        video.setAttribute('controls', false);
        audio.setAttribute('controls', false);
      } else {
        video.setAttribute('controls', true);
        audio.setAttribute('controls', true);
      }
      saveState();
    }
    function setClock24(c) {
      clock24 = c;
      clockToggle.setAttribute('data-on', c);
      saveState();
    }
    function showError(msg) {
      playerError.textContent = msg;
      playerError.style.display = '';
    }
    function hideError() {
      playerError.style.display = 'none';
      playerError.textContent = '';
    }
    function playChannel(idx) {
      if (!channels[idx]) return;
      current = idx;
      saveState();
      const ch = channels[idx];
      // Detect audio-only
      const isAudio = /\.(mp3|aac|m4a|ogg|flac|wav)(\?|$)/i.test(ch.url) || ch.url.includes('icy') || ch.url.includes('audio');
      const isHls = /\.m3u8(\?|$)/i.test(ch.url);
      video.style.display = isAudio ? 'none' : '';
      audio.style.display = isAudio ? '' : 'none';
      stopBtn.style.display = '';
      hideError();
      // Clean up previous hls.js instance
      if (hls) {
        hls.destroy();
        hls = null;
      }
      if (isAudio) {
        lastType = 'audio';
        audio.src = ch.url;
        audio.play().catch(()=>{});
        video.pause();
        video.src = '';
      } else if (isHls) {
        lastType = 'video';
        if (video.canPlayType('application/vnd.apple.mpegurl')) {
          video.src = ch.url;
        } else if (window.Hls) {
          hls = new Hls();
          hls.loadSource(ch.url);
          hls.attachMedia(video);
        } else {
          showError('HLS not supported.');
        }
        video.play().catch(()=>{});
        audio.pause();
        audio.src = '';
      } else {
        lastType = 'video';
        video.src = ch.url;
        video.play().catch(()=>{});
        audio.pause();
        audio.src = '';
      }
      currentName.textContent = ch.name;
      if (ch.logo) {
        currentLogo.src = ch.logo;
        currentLogo.style.display = '';
      } else {
        currentLogo.style.display = 'none';
      }
      // Highlight in channel list
      document.querySelectorAll('.channel-item').forEach((el,i)=>{
        el.classList.toggle('selected', i===idx);
      });
    }
    function stopPlayback() {
      if (hls) { hls.destroy(); hls = null; }
      video.pause();
      video.src = '';
      audio.pause();
      audio.src = '';
      stopBtn.style.display = 'none';
      hideError();
    }
    function showModal() {
      modal.style.display = '';
      channelList.scrollTop = current*48-60;
      setTimeout(()=>modal.querySelector('.modal-content').focus(), 100);
    }
    function hideModal() {
      modal.style.display = 'none';
    }
    function renderChannelList() {
      channelList.innerHTML = '';
      channels.forEach((ch,i)=>{
        const div = document.createElement('div');
        div.className = 'channel-item'+(i===current?' selected':'');
        div.tabIndex = 0;
        div.innerHTML = `<img class=\"channel-logo\" src=\"${ch.logo}\" alt=\"\" onerror=\"this.style.display='none'\"> <span>${ch.name}</span>`;
        div.onclick = ()=>{ playChannel(i); hideModal(); };
        div.onkeydown = e=>{
          if (e.key==='Enter') { playChannel(i); hideModal(); }
        };
        channelList.appendChild(div);
      });
    }
    function updateClock() {
      const now = new Date();
      let h = now.getHours(), m = now.getMinutes();
      let ampm = '';
      if (!clock24) {
        ampm = h>=12?' PM':' AM';
        h = h%12; if (h===0) h=12;
      }
      clock.textContent = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}${ampm}`;
    }
    // --- Event Listeners ---
    stopBtn.onclick = stopPlayback;
    settingsBtn.onclick = ()=>{ renderChannelList(); showModal(); };
    modalClose.onclick = hideModal;
    lightToggle.onclick = ()=> setLight(!lightMode);
    autohideToggle.onclick = ()=> setAutohide(!autoHide);
    clockToggle.onclick = ()=> setClock24(!clock24);
    // Keyboard navigation
    document.addEventListener('keydown', e=>{
      if (modal.style.display!=='none') {
        if (e.key==='Escape') { hideModal(); }
        return;
      }
      if (e.target.tagName==='TEXTAREA') return;
      if (e.key==='ArrowRight') {
        playChannel((current+1)%channels.length);
      } else if (e.key==='ArrowLeft') {
        playChannel((current-1+channels.length)%channels.length);
      } else if (e.key==='s' || e.key==='S') {
        stopPlayback();
      } else if (e.key==='c' || e.key==='C') {
        renderChannelList(); showModal();
      }
    });
    // Error handling
    video.onerror = audio.onerror = ()=>{
      showError('Failed to load stream.');
    };
    video.onplay = audio.onplay = hideError;
    video.onloadeddata = audio.onloadeddata = hideError;
    video.oncanplay = audio.oncanplay = hideError;
    // Auto-hide controls
    let hideTimeout = null;
    function setAutohideEvents() {
      if (!autoHide) return;
      const player = lastType==='audio'?audio:video;
      player.removeAttribute('controls');
      player.onmousemove = ()=>{
        player.setAttribute('controls','');
        clearTimeout(hideTimeout);
        hideTimeout = setTimeout(()=>{
          player.removeAttribute('controls');
        }, 2000);
      };
      player.onmouseleave = ()=>{
        player.removeAttribute('controls');
      };
    }
    setInterval(updateClock, 1000);
    // --- Init ---
    (function init() {
      loadState();
      setLight(lightMode);
      setAutohide(autoHide);
      setClock24(clock24);
      if (!channels.length) {
        channels = parseM3U(EMBEDDED_M3U);
        saveState();
      }
      renderChannelList();
      
      // Hide splash screen after a short delay
      setTimeout(() => {
        splash.classList.add('hidden');
        setTimeout(() => {
          splash.style.display = 'none';
          playChannel(current);
        }, 500);
      }, 2000);
    })();
  </script>
</body>
</html>
